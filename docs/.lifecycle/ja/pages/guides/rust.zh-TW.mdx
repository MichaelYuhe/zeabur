---
title: Rust
ogImageTitle: 部署 Rust アプリケーション
ogImageSubtitle: Zeabur で Rust アプリケーションをデプロイする
---

# 部署 Rust アプリケーション

基本的には、すべての種類の Rust アプリケーションに対応しています。通常は実行ファイルを自動的に見つけます。ただし、プロジェクトに複数の実行ファイルがある場合、「サービス名」の列に実行するファイルの名前を自分で指定することもできます。

プロジェクトがない場合は、[zeabur/axum-template](https://github.com/zeabur/axum-template) リポジトリを GitHub アカウントにフォークして、Zeabur でデプロイを試してみることができます。

## サポートされているプロジェクトの種類

- シングルバイナリプロジェクト: `src/main.rs` のみをエントリポイントとする Rust プロジェクト。Zeabur は通常、`target/release` にある唯一の実行可能ファイルを自動的に見つけます。また、「サービス名」の列に、「実行するファイルの名前」を記入することで、期待通りのファイルが実行されることを保証することができます。
- マルチバイナリプロジェクト: `src/main.rs` に加えて、`src/bin` に他の実行ファイルがある場合、「サービス名」の列に「実行するファイルの名前」を記入します。
- Cargo ワークスペースモノリポ: プロジェクトが複数のクレートで構成されている場合、「サービス名」の列に「実行するファイルの名前」を記入します。

入力した実行ファイルが存在しない場合は、自動検索の形式に切り替わります。「自動検索」では、`target/release` にあるすべてのファイルを検索し、見つかった最初のファイルを実行します。このモードは複数のプロジェクトの状況下で簡単に間違える可能性があるため、複雑なプロジェクトシナリオ（マルチバイナリプロジェクトとCargo ワークスペースモノリポで言及されている 2 つ目と3 つ目のポイント）では、「サービス名」に正しい名前を記入する形式で最終製品の名前を検索することをお勧めします。

## 最終製品名の検索

最終製品はプロジェクトの `target/release` にあります。具体的な検索方法は次のとおりです：

1. プロジェクトをコンパイルするために Rust ツールチェーンが必要です。[Rust 公式サイト](https://www.rust-lang.org) からダウンロードできます。
2. デプロイするプロジェクトをクローンし、プロジェクトディレクトリに移動します。
3. `cargo build --release` を実行してプロジェクトをコンパイルします。

    ```bash
    $ cargo run --release
    Compiling zeabur v0.1.0 (/project)
      Finished release [optimized] target(s) in 0.65s
      Running `target/release/zeabur`
    ```

4. `Running target/release/zeabur` の行を見つけ、最後の実行ファイル名（zeabur）を取得します。
5. サービス名に `zeabur` を入力します。

## その他のファイルのコピー

実行ファイル以外にも、プログラムがコードライブラリの他のファイルに依存している場合があります。たとえば：

```plain
*
|`-- public  <-- プログラムがこのディレクトリに依存している
|`-- src
|  `-- main.rs
|`-- Cargo.toml
|`-- Cargo.lock
`--- config.toml   <-- プログラムがこのファイルに依存している
```

プログラムライブラリに `.zeabur-preserve` ファイルを入力します。そこには保持したいディレクトリやファイルを記入できます。ディレクトリは `/` で終わるように選択できます。次のような例です：

```plain
public/
config.toml
```

## 技術的詳細と注意事項

- マルチステージビルドがデフォルトで採用され、ランタイムはベースイメージとして `docker.io/library/debian:bookworm-slim` が使用されます。一部のダイナミックリンクライブラリは、このイメージに移行する際に特定のパッケージが不足しているため正常に機能しない場合があります。このような場合は、このパッケージのサポートを追加するために報告してください。
  - 現在、特にインストールされる依存パッケージには `openssl` があります。
- 実行時にルート権限は提供されず、関連する必要がある場合は、独自の Dockerfile を作成する必要があります。
- コンパイル速度を向上させるために、`lld` を使用しています。プロジェクトが `lld` をサポートしていない場合は、標準の `ld` を呼び出すようにプロジェクトで指定することをお勧めします。また、`mold` などの組み込みでないリンカを使用したい場合は、独自の Dockerfile を作成する必要があります。
- キャッシュされたビルドレイヤを最大限に活用するために `cargo-chef` を使用しています。互換性のない問題が発生した場合は、Zeabur または上流の [`LukeMathWalker/cargo-chef`](https://github.com/LukeMathWalker/cargo-chef) に報告することができます。

{/* converted with zhconvert.org | revision dict-a1f426e3-r1031 */}
